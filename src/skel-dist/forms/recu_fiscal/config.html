{{:admin_header title="Configuration du reçu fiscal"}}

{{if $_POST.save}}
	{{if $_POST.topic|trim == ''}}
		<p class="error block">L'objet de l'association n'a pas été renseigné.</p>
	{{elseif $_POST.accounts|trim == ''}}
		<p class="error block">Les comptes éligibles aux reçus n'ont pas été renseignés.</p>
	{{elseif $_POST.accounts_cash|trim == ''}}
		<p class="error block">Les comptes d'espèces n'ont pas été renseignés.</p>
	{{elseif $_POST.accounts_cheques|trim == ''}}
		<p class="error block">Les comptes de chèques n'ont pas été renseignés.</p>
	{{else}}
		{{:save key="config"
			accounts=$_POST.accounts
			topic=$_POST.topic
			accounts_cash=$_POST.accounts_cash
			accounts_cheques=$_POST.accounts_cheques
			art200=$_POST.art200
			art238=$_POST.art238
			art885=$_POST.art885
		}}
		{{:http redirect="?ok=1"}}
	{{/if}}
{{/if}}

{{if $_GET.ok}}
	<p class="block confirm">Configuration enregistrée.</p>
{{/if}}

<form method="post" action="">

<fieldset>
	<legend>Configuration du modèle de reçu fiscal</legend>
	<dl>
		{{:input required=true name="topic" type="textarea" label="Objet de l'association" source=$form.config cols="70" rows="4" help="Inscrire ici l'objet de l'association, conformément aux statuts."}}
		{{:input required=false name="accounts" type="text" label="Numéros des comptes éligibles aux reçus" source=$form.config default="756"}}
		<dd class="help">
			Pour chaque numéro de compte indiqué dans ce champ, le reçu de don sera proposé (en dessous de la fiche de l'écriture).<br />
			Séparer les numéros de compte avec des virgules, par exemple : <tt>754, 756</tt>.<br />
			Laisser vide pour que le reçu de don soit proposé quel que soit le compte.
		</dd>
		{{:input required=true name="accounts_cash" type="text" label="Numéros des compte de caisse" source=$form.config default="530"}}
		<dd class="help">
			Utilisé pour cocher automatiquement la bonne case dans le reçu.<br />
			Séparer les numéros de compte avec des virgules, par exemple : <tt>530, 5301</tt>.
		</dd>
		{{:input required=true name="accounts_cheques" type="text" label="Numéros des comptes pour les chèques" source=$form.config default="5112"}}
		<dd class="help">
			Utilisé pour cocher automatiquement la bonne case dans le reçu.<br />
			Séparer les numéros de compte avec des virgules, par exemple : <tt>5112, 5113</tt>.
		</dd>
		<dt>Réduction d'impôt éligibles&nbsp;:</dt>
		{{:input type="checkbox" name="art200" value="1" source=$form.config label="Article 200"}}
		{{:input type="checkbox" name="art238" value="1" source=$form.config label="Article 238 bis"}}
		{{:input type="checkbox" name="art885" value="1" source=$form.config label="Article 885-0V bis A"}}
	</dl>
</fieldset>

<p class="submit">
	{{:button type="submit" name="save" label="Enregistrer" shape="right" class="main"}}
</p>

</form>

{{:admin_footer}}